<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>JSE Sentiment Analysis</title>
  <style>
    /* Center a container of fixed max-width in the middle of the page */
    .page-container {
      max-width: 900px;   /* adjust as you like: 800px, 1000px, etc. */
      margin: 0 auto;     /* auto left/right margins center the container */
      padding: 20px;      /* optional padding for breathing room */
    }

    body {
      font-family: Arial, sans-serif;
      /* We don't strictly need margin on <body> if .page-container has it */
      margin: 0;
      padding: 0;
      background-color: #fff;
    }

    h1 {
      margin-bottom: 10px;
      text-align: center; /* Headline centered for a nicer look */
    }

    input {
      margin-right: 5px;
    }
    #errorMessage {
      margin-top: 10px;
      font-weight: bold;
    }
    #currentPriceDisplay {
      margin-top: 5px;
    }

    table {
      margin-top: 15px;
      border-collapse: collapse;
      width: 100%;     /* Let the table fill the containerâ€™s width */
    }
    table thead {
      background-color: #f4f4f4;
    }
    table th,
    table td {
      padding: 8px 12px;
      text-align: center;
      vertical-align: middle;
      border-bottom: 1px solid #ccc;
    }
    table th {
      border-bottom: 2px solid #ccc;
    }

    .chart-container {
      position: relative;
      margin-top: 8px;
      padding: 10px 10px 30px 10px;
      background-color: #fcfcfc;
      border: 1px solid #ccc;
      border-radius: 8px;
      min-height: 120px;
    }
    .chart-title {
      font-weight: bold;
      text-align: center;
      margin-bottom: 8px; 
    }

    .price-range-track {
      position: relative;
      height: 8px;
      background-color: #ccc;
      border-radius: 4px;
      margin: 30px auto 10px auto;
      z-index: 1;
    }

    .price-dot {
      position: absolute;
      top: 50%;
      width: 10px;
      height: 10px;
      background-color: #666;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      z-index: 2;
    }
    .price-label {
      position: absolute;
      transform: translate(-50%, -140%);
      background-color: #fff;
      border: 1px solid #aaa;
      border-radius: 3px;
      padding: 2px 4px;
      font-size: 12px;
      white-space: nowrap;
      z-index: 3;
    }
    .price-dot.current {
      background-color: #d00;
    }
    .price-label.current {
      color: #d00;
      border-color: #d00;
      font-weight: bold;
    }

    .chartRow {
      display: none;
    }
    .clickable-row {
      cursor: pointer;
    }

    .arrow-cell {
      text-align: left;
      position: relative;
    }
    .arrow-icon {
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      font-weight: bold;
    }
    .ticker-text {
      margin-left: 25px;
    }
  </style>
</head>
<body>

  <div class="page-container">
    <h1>JSE Sentiment Analysis</h1>

    <!-- Inputs for ticker + price prediction -->
    <input type="text" id="tickerInput" placeholder="Enter Stock Ticker (e.g. ECL)" />
    <input type="number" id="priceInput" placeholder="1-Year Price Prediction ($)" />
    <button id="submitPrediction">Submit Prediction</button>

    <p id="errorMessage"></p>
    <p id="currentPriceDisplay"></p>

    <table id="predictionsTable">
      <thead>
        <tr>
          <th>Ticker</th>
          <th>Current Price ($)</th>
          <th>Avg Prediction Price ($)</th>
          <th>Potential Upside/Downside (%)</th>
          <th>Prediction Count</th>
        </tr>
      </thead>
      <tbody id="predictionsBody"></tbody>
    </table>
  </div>

  <!-- All the same JS logic as before, just wrapped in .page-container for centering. -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-analytics.js";
    import { getDatabase, ref, onValue, push } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSy...",
      authDomain: "jse-sentiment-analysis.firebaseapp.com",
      databaseURL: "https://jse-sentiment-analysis-default-rtdb.firebaseio.com",
      projectId: "jse-sentiment-analysis",
      storageBucket: "jse-sentiment-analysis.appspot.com",
      messagingSenderId: "225282121975",
      appId: "1:225282121975:web:29bd14c63a4c11fc66b3f2",
      measurementId: "G-VLGXC41LME"
    };
    const app = initializeApp(firebaseConfig);
    getAnalytics(app);
    const db = getDatabase(app);

    // ...the rest of your code is unchanged (fetching tickers.json, etc.)...
    // (Paste in the same logic for submitPrediction, onValue, renderPredictionTable, etc.)
    
    const tickersUrl = "https://raw.githubusercontent.com/matthewpres/JSE-Sentiment/main/tickers.json";
    let stockPrices = {};

    fetch(tickersUrl)
      .then(res => res.json())
      .then(data => {
        stockPrices = data;
        updateAutocomplete();
      })
      .catch(err => console.error("Error loading tickers:", err));

    function updateAutocomplete() {
      // ...
    }

    document.getElementById("submitPrediction").addEventListener("click", () => {
      // ...
    });

    const predictionsRef = ref(db, "predictions");
    onValue(predictionsRef, (snapshot) => {
      // ...
    });

    function renderPredictionTable(predictionsMap) {
      // ...
    }

    function renderPriceTargetChart(ticker, predictions, currentPrice) {
      // ...
    }

    function createDot(percent, priceValue, labelText, isCurrent=false) {
      // ...
    }
  </script>
</body>
</html>
